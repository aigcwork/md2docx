<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>Markdown 转 Word 在线转换器</title>
    <style>
        body { font-family: sans-serif; display: flex; flex-direction: column; align-items: center; padding: 20px; background-color: #f4f7f9; }
        .container { width: 90%; max-width: 800px; background-color: #fff; padding: 20px; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        textarea { width: 100%; box-sizing: border-box; min-height: 400px; margin-bottom: 20px; font-size: 16px; border: 1px solid #ccc; border-radius: 4px; padding: 10px; resize: vertical; }
        button { width: 100%; padding: 12px 25px; font-size: 18px; cursor: pointer; background-color: #007bff; color: white; border: none; border-radius: 4px; }
        button:disabled { background-color: #ccc; }
        p#status { margin-top: 20px; font-size: 16px; color: #555; height: 20px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>在线 Markdown 转 Word 转换器</h1>
        <textarea id="markdown-input"># 最终中文测试成功！

这是一个包含**中文**的段落。

这是一个行内公式：$E=mc^2$

这是一个带有 `\sum` 和 `\frac` 的复杂公式：
$$
\sum_{i=1}^{n} i = \frac{n(n+1)}{2}
$$
</textarea>
        <button id="convert-btn">转换并下载 DOCX</button>
        <p id="status"></p>
    </div>

    <script>
        const convertBtn = document.getElementById('convert-btn');
        const markdownInput = document.getElementById('markdown-input');
        const statusEl = document.getElementById('status');
        
        // 【【【 最关键的一步！请务必将这里的地址替换成您唯一的、正确的URL 】】】
        const apiUrl = "https://md-docx-mehieddhoq.cn-hongkong.fcapp.run/api/convert";

        convertBtn.addEventListener('click', async () => {
            const markdownText = markdownInput.value;
            if (!markdownText.trim()) { alert('请输入内容！'); return; }

            convertBtn.textContent = '转换中...';
            convertBtn.disabled = true;
            statusEl.textContent = '正在向云端发送请求...';

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ markdown: markdownText })
                });
                
                if (!response.ok) { throw new Error(`服务器返回错误，状态: ${response.status}`); }

                const blob = await response.blob();
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'final_document.docx';
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
                statusEl.textContent = '下载成功！';
            } catch (error) {
                statusEl.textContent = `发生错误: ${error.message}`;
                alert(`发生错误: ${error.message}`);
            } finally {
                convertBtn.textContent = '转换并下载 DOCX';
                convertBtn.disabled = false;
            }
        });
    </script>
</body>
</html>